<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="icon" href="/images/market/logo.webp" type="image/jpeg">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confirmation d'achat</title>
  <link rel="stylesheet" href="styles.css">

<!-- TikTok Pixel base (si non inclus via layout commun) -->
<script>
!function (w,d,t) {
  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];
  ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"];
  ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat([].slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
  ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e};
  ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js";
    n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src=r+"?sdkid="+e+"&lib="+t;
    e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
  ttq.load('D3F46ERC77UCTDLGVG9G');  // <-- ton Pixel ID
  ttq.page();
}(window,document,'ttq');
</script>

<!-- Event Purchase TikTok avec les m√™mes param√®tres que FB/GA -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  var params    = new URLSearchParams(location.search);
  var amount    = parseFloat(params.get('amount') || '30');   // m√™me logique que FB
  var plan      = (params.get('plan') || 'quarterly').toLowerCase();
  var sessionId = params.get('session_id') || '';             // utile comme order_id
  var sku       = plan === 'annual' ? 'premium_annual' : 'premium_quarterly';

  if (window.ttq && !Number.isNaN(amount)) {
    ttq.track('CompletePayment', {
      value: amount,
      currency: 'EUR',
      contents: [{ id: sku, quantity: 1 }],
      content_type: 'product',
      order_id: sessionId  // facultatif mais pratique pour la d√©dup & debug
    });
    console.log('üéØ TikTok CompletePayment envoy√©', { amount, plan, sessionId });
  } else {
    console.warn('‚ö†Ô∏è TikTok ttq non dispo ou amount invalide');
  }
});
</script>




<!-- Google Analytics (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FJ5S0H9B1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }

  gtag('js', new Date());

  document.addEventListener('DOMContentLoaded', () => {
    const fullUrl = window.location.pathname + window.location.search;
    gtag('config', 'G-FJ5S0H9B1R', {
      page_path: fullUrl
    });

    const params = new URLSearchParams(window.location.search);
    const amount = params.get("amount");
    const plan = params.get("plan") || "unknown";

    const selectedTest = JSON.parse(localStorage.getItem("selectedPricingTest"));
    let abTestId = selectedTest?.id || "unknown";

    // üîç Si aucun test enregistr√©, on essaie via cookie et JSON forc√©
    if (abTestId === "unknown") {
      const cookie = document.cookie.split('; ').find(row => row.startsWith('forcedTp='));
      const forcedTp = cookie ? cookie.split('=')[1] : null;

      if (forcedTp) {
        fetch('/forced-pricing.json')
          .then(res => res.json())
          .then(config => {
            const forcedPlan = config[forcedTp];
            if (forcedPlan && forcedPlan.test_id) {
              abTestId = forcedPlan.test_id;
              localStorage.setItem("selectedPricingTest", JSON.stringify({ id: abTestId }));
            }
            triggerGAEvent(); // ‚úÖ Lancer GA apr√®s avoir le bon ID
          })
          .catch(err => {
            console.error("‚ùå Erreur forced-pricing.json :", err);
            triggerGAEvent(); // fallback avec "unknown"
          });
      } else {
        triggerGAEvent();
      }
    } else {
      triggerGAEvent(); // cas classique : test d√©j√† en localStorage
    }

    function triggerGAEvent() {
      if (!amount) return;
      gtag('event', 'purchase', {
        value: parseFloat(amount),
        currency: 'EUR',
        abTestId: abTestId,
        items: [{
          item_name: plan,
          price: parseFloat(amount)
        }]
      });

      console.log("üéØ GA Event : purchase =", {
        value: amount,
        plan,
        abTestId
      });
    }
  });
</script>



<meta http-equiv="Delegate-CH" content="sec-ch-ua https://ads.trafficjunky.net; sec-ch-ua-arch https://ads.trafficjunky.net; sec-ch-ua-full-version-list https://ads.trafficjunky.net; sec-ch-ua-mobile https://ads.trafficjunky.net; sec-ch-ua-model https://ads.trafficjunky.net; sec-ch-ua-platform https://ads.trafficjunky.net; sec-ch-ua-platform-version https://ads.trafficjunky.net;">



  
</head>
<body>

<!-- START ExoClick Goal Tag | Achat abonnement -->
<script type="application/javascript" src="https://a.magsrv.com/tag_gen.js" data-goal="8f5ae8e33257ea42f1184f0f647f5d05" ></script>
<!-- END ExoClick Goal Tag | Achat abonnement -->

  <!-- Contenu principal -->
  <div class="container confirmation-page">
    <h1 class="p-title">Active le MODE NYMPHOMANE <u>MAINTENANT</u></h1>
    <div class="popup-hero">
  <video class="popup-hero__video" autoplay muted loop playsinline>
    <source src="/images/market/nova-jetons.mp4" type="video/mp4">
  </video>
  
  </div>
  <br>
    <p class="p-description">
      F√©licitations, tu as d√©bloqu√© toutes les fonctionnalit√©s premium (messages, photos et vid√©os illimit√©es).
    </p>
    <p class="p-description">
      Tu vas √©galement pouvoir acc√©der au MODE NYMPHOMANE.
    </p>

     <p class="p-description">
      L'abonnement premium est suffisant si tu aimes les contenus sexy...
    </p>
      <p class="p-description">Mais si tu veux voir des vid√©os tr√®s chaudes (<b><u>sans soutif, sans culotte...</u></b>), prends tout de suite des jetons pour activer le MODE NYMPHOMANE sur nos IA.</p>
    </p>
    
      <p class="p-description"><b><span style="color: #ff9cef;">Le MODE NYMPHOMANE co√ªte 25 jetons pour l'activer sur une IA.</p>

<div style="max-width: 450px; margin:auto;">
     <div class="offers">
      <img src="/images/market/carte-1c-10jetons.webp" class="offer-img" data-tokens="10" data-price="5">
  <img src="/images/market/carte-1c-50jetons.webp" class="offer-img" data-tokens="50" data-price="25">
  <img src="/images/market/carte-1c-100jetons.webp" class="offer-img" data-tokens="100" data-price="39">
  <img src="/images/market/carte-1c-300jetons.webp" class="offer-img" data-tokens="300" data-price="99">
  <img src="/images/market/carte-1c-700jetons.webp" class="offer-img" data-tokens="700" data-price="199">
  <img src="/images/market/carte-1c-1000jetons.webp" class="offer-img" data-tokens="1000" data-price="249">
</div>

</div>

    <br>
    <p>Avantages des jetons :</p>
 <ul class="benefit-list">
        <li><span class="benefit-icon"></span> Mode nymphomane (25 jetons)</li>
        <li><span class="benefit-icon"></span> Appels audio (20 jetons pour 10 min)</li>
        <li><span class="benefit-icon"></span> Contenus priv√©s</li>
         <li><span class="benefit-icon"></span> Message vocaux (5 jetons/minute)</li>
         <li><span class="benefit-icon"></span> Photo envoy√©e depuis ta galerie (1 jeton/image)</li>
      
      </ul>
      

  <!-- T√©moignages clients -->
<div class="testimonial-section">
  <h2 class="testimonial-title">Ils ont pris des jetons‚Ä¶ et sont devenus accro</h2>
  <div class="testimonial-grid">

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"J‚Äôai mis le mode nympho sur L√©a‚Ä¶ j‚Äôte jure c‚Äôest plus la m√™me. Elle m‚Äôa chauff√© comme jamais üî•"</p>
      <p class="testimonial-author">‚Äî Karim M.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"Jasmine √©tait toute sage au d√©but‚Ä¶ et l√† d‚Äôun coup c‚Äôest t√©tons √† l‚Äôair, doigts entre les jambes üò≥ j‚Äô√©tais pas pr√™t"</p>
      <p class="testimonial-author">‚Äî Lucas R.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"25 jetons pour voir ton IA se d√©cha√Æner ? C‚Äôest cadeau mec. Elle m‚Äôa envoy√© des nudes direct üòà"</p>
      <p class="testimonial-author">‚Äî Steph G.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"Franchement j‚Äôme disais √ßa va √™tre fake‚Ä¶ bah nan üò≠ elle m‚Äôa chauff√© tout l‚Äôchat, photos √† poil non stop"</p>
      <p class="testimonial-author">‚Äî Bast D.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"Elle √©tait cute au d√©but‚Ä¶ mtn elle m‚Äôappelle ‚Äúmon cochon‚Äù et elle montre tout üò≠üî•"</p>
      <p class="testimonial-author">‚Äî Enzo L.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"Tu cliques sur mode nympho et BOUM üí• elle te balance des photos... sans rien, toute chaude"</p>
      <p class="testimonial-author">‚Äî Max B.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"J‚Äôai test√© les vocaux... gros j‚Äôai eu une √©rection en 10 sec üòÖ sa voix c‚Äôest abus√©"</p>
      <p class="testimonial-author">‚Äî Adrien P.</p>
    </div>

    <div class="testimonial-card">
      <div class="testimonial-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="testimonial-text">"Elle m‚Äôa susurr√© des trucs‚Ä¶ j‚Äôme croyais dans une sextape. Trop r√©aliste üòµ‚Äçüí´"</p>
      <p class="testimonial-author">‚Äî Q. Vasseur</p>
    </div>  

  </div>

  
<!-- Section FAQ interactive -->
<div class="faq-section">
  <h2 class="faq-title">Questions Fr√©quemment Pos√©es</h2>

  <div class="faq-item">
    <button class="faq-question">Comment fonctionne le mode "Nymphomane" ?</button>
    <div class="faq-answer">
      <p>Le mode "Nymphomane" transforme l'I.A de ton choix : elle devient plus coquine, plus directe, et commence √† t‚Äôenvoyer des photos beaucoup plus intimes. M√™me les I.A les plus r√©serv√©es changent compl√®tement de comportement. L‚Äôexp√©rience est bien plus intense.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Combien de jetons faut-il pour activer le mode Nympho ?</button>
    <div class="faq-answer">
      <p>Activer le mode Nymphomane co√ªte 25 jetons pour une heure. Tu peux l‚Äôactiver autant de fois que tu veux, sur l‚ÄôI.A que tu veux.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Comment se d√©roulent les appels audio ?</button>
    <div class="faq-answer">
      <p>Tu peux lancer un appel vocal avec ton I.A. Elle te parle avec une vraie voix, en direct, comme une vraie conversation intime au t√©l√©phone. Chaque appel dure 10 minutes et co√ªte 20 jetons.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">√Ä quoi servent les jetons ?</button>
    <div class="faq-answer">
      <p>Les jetons permettent de d√©bloquer des options avanc√©es : envoi de tes propres photos, messages vocaux illimit√©s, appels audio, ou encore l‚Äôacc√®s au mode Nymphomane. C‚Äôest ce qui rend l‚Äôexp√©rience plus immersive et excitante.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Puis-je envoyer mes propres photos ?</button>
    <div class="faq-answer">
      <p>Oui. Avec l‚Äôabonnement Premium, tu peux en envoyer 10 par mois. Ensuite, chaque photo suppl√©mentaire co√ªte 1 jeton. L‚ÄôI.A r√©agit √† chaque image avec un commentaire personnalis√©.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Comment fonctionnent les messages vocaux ?</button>
    <div class="faq-answer">
      <p>Ton I.A peut te r√©pondre par message vocal. Tu as 1 minute gratuite par mois. Ensuite, tu peux prolonger l‚Äô√©coute avec 5 jetons par minute suppl√©mentaire.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Quelle est la diff√©rence entre Premium et les jetons ?</button>
    <div class="faq-answer">
      <p>L‚Äôabonnement Premium te donne acc√®s aux fonctions de base en illimit√© (chat, photos flout√©es retir√©es, vid√©os normales). Les jetons, eux, te permettent d‚Äôaller plus loin et d‚Äôexplorer des options tr√®s sensuelles, comme les appels ou les photos intimes.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Les jetons ont-ils une date d‚Äôexpiration ?</button>
    <div class="faq-answer">
      <p>Non. Tes jetons sont valables sans limite de temps. Tu peux les utiliser quand tu veux, m√™me dans plusieurs mois.</p>
    </div>
  </div>

  <div class="faq-item">
    <button class="faq-question">Et si j‚Äôai un souci avec mon paiement ?</button>
    <div class="faq-answer">
      <p>Notre support client est r√©actif. Si un paiement pose probl√®me ou si tu n‚Äôas pas re√ßu tes jetons, contacte-nous via la page "Contact" et on r√©glera √ßa rapidement.</p>
    </div>
  </div>
</div>

  <!-- Ic√¥nes de s√©curit√© -->
  <div class="security-section">
    <div class="security-item">
      <i class="fas fa-lock"></i>
      <p>100% S√©curis√©</p>
    </div>
    <div class="security-item">
      <i class="fas fa-mask"></i>
      <p>Confidentialit√© totale</p>
    </div>
  </div>

  
  

  <!-- ‚úÖ POPUP CONFIRMATION cach√©e au d√©marrage -->
  <div id="confirm-popup" class="confirm-popup hidden">
    <div class="confirm-content">
      <button class="close-btn" onclick="closeConfirmPopup()">√ó</button>
      <img src="/images/market/carte-credit.webp" class="card-icon" />
      <h3>Confirmer ton achat ?</h3>
      <p>Tu es sur le point d‚Äôacheter <span id="confirm-amount"></span> jetons pour <span id="confirm-price"></span>‚Ç¨</p>
      <div class="confirm-buttons">
        <button onclick="closeConfirmPopup()">Annuler</button>
        <button onclick="sendJetonsPayment()">Confirmer</button>
      </div>
    </div>
  </div>

  <!-- ‚ù§Ô∏è Loader pendant le paiement 1C -->
<!-- ‚úÖ Loader pendant le paiement -->
<div id="loader-overlay" class="loader-overlay hidden">
  <div class="spinner"></div>
  <p class="loader-text">Paiement en cours‚Ä¶</p>
</div>

<!-- ‚úÖ JavaScript -->
<script>
  let selectedOffer = null;

  function openJetonsPopup() {
    document.getElementById("jetons-popup")?.classList.remove("hidden");
  }

  function closeJetonsPopup() {
    document.getElementById("jetons-popup")?.classList.add("hidden");
  }

  function closeConfirmPopup() {
    document.getElementById("confirm-popup")?.classList.add("hidden");
  }

  function selectOffer(tokens, price) {
    selectedOffer = { tokens, price };
    document.getElementById("confirm-amount").textContent = tokens;
    document.getElementById("confirm-price").textContent = price;
    document.getElementById("confirm-popup").classList.remove("hidden");
  }

  async function sendJetonsPayment() {
    if (!selectedOffer) return;

    const userData = JSON.parse(localStorage.getItem('user') || '{}');
    const email = userData.email;

    if (!email) {
      alert("Email non trouv√©. Veuillez vous reconnecter.");
      return;
    }

    const loader = document.getElementById("loader-overlay");
    loader.classList.remove("hidden"); // üëà Affiche le loader

    // (Optionnel) Emp√™che les doubles clics
    const confirmBtn = document.getElementById("confirm-buy-btn");
    confirmBtn?.setAttribute("disabled", "true");

    try {
      const res = await fetch('/api/one-click-payment', {
        method: 'POST',
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          email,
          tokensAmount: selectedOffer.tokens
        })
      });

      // Essaye de parser le JSON m√™me si status non-2xx
      let data = {};
      try { data = await res.json(); } catch (_) {}

      loader.classList.add("hidden"); // üëà Cache le loader
      confirmBtn?.removeAttribute("disabled");

      if (res.ok && data.success) {
        closeConfirmPopup();
        closeJetonsPopup();
        alert("‚úÖ Jetons achet√©s avec succ√®s !");
        return;
      }

      // ‚ùå Erreur retourn√©e par l'API
      alert("‚ùå Paiement √©chou√© : " + (data.message || "Erreur inconnue"));
      if (data.redirect) {
        window.location.href = data.redirect; // üëâ priorise l'URL renvoy√©e par le backend
      } else {
        window.location.href = "/jetons.html"; // üëâ fallback
      }

    } catch (err) {
      loader.classList.add("hidden"); // üëà Cache le loader m√™me en cas d‚Äôerreur
      confirmBtn?.removeAttribute("disabled");
      console.error("‚ùå Erreur lors du paiement 1C :", err);
      alert("Erreur serveur. Redirection vers la page jetons.");
      window.location.href = "/jetons.html"; // üëâ fallback ultime
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".offer-img").forEach(img => {
      img.addEventListener("click", () => {
        const tokens = img.dataset.tokens;
        const price = img.dataset.price;
        selectOffer(tokens, price);
      });
    });

    // ‚úÖ On ne cache QUE la confirmation, pas la popup principale
    closeConfirmPopup();
  });

  // üëá Rendez les fonctions accessibles globalement
  window.openJetonsPopup = openJetonsPopup;
  window.closeJetonsPopup = closeJetonsPopup;
  window.closeConfirmPopup = closeConfirmPopup;
  window.selectOffer = selectOffer;
  window.sendJetonsPayment = sendJetonsPayment;
</script>



<script>
  if (window.location.pathname.endsWith("popup1c.html")) {
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("jetons-popup")?.classList.remove("hidden");
    });
  }
</script>


 
  <!-- Scripts FAQ -->
  <script>
  document.querySelectorAll('.faq-question').forEach(button => {
    button.addEventListener('click', () => {
      const answer = button.nextElementSibling;
      answer.classList.toggle('open');
    });
  });
</script>


  <!-- Inclure les fichiers JavaScript -->
 <script type="module" src="/scripts/menu-loader.js"></script>

  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window,document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
  
    fbq('init', '1139964937955152'); // ‚úÖ Ton Pixel ID
  
    // üî• G√©n√©ration d'un eventID unique pour √©viter les doublons
    var purchaseEventID = 'purchase_' + Date.now();
  
    // ‚úÖ R√©cup√©ration dynamique du montant depuis l'URL (par d√©faut : 10‚Ç¨)
    var urlParams = new URLSearchParams(window.location.search);
    var amount = urlParams.get('amount') ? parseFloat(urlParams.get('amount')) : 10;
  
    // ‚úÖ Envoi de l'√©v√©nement "Purchase" avec la vraie valeur
    fbq('track', 'Purchase', {
      value: amount, // üî• Montant dynamique
      currency: 'EUR'
    }, {
      eventID: purchaseEventID // ‚úÖ Cl√© pour √©viter les doublons
    });
  
    // ‚úÖ Suppression du stockage inutile pour l‚ÄôAPI CAPI (car d√©sactiv√©e)
  </script>
  
  <script>
    function getFacebookParams() {
        var urlParams = new URLSearchParams(window.location.search);
  
        // ‚úÖ R√©cup√©ration du param√®tre `fbclid` pour fbc
        var fbc = urlParams.get('fbclid') 
            ? "fb." + Math.floor(Date.now() / 1000) + "." + urlParams.get('fbclid') 
            : null;
  
        // ‚úÖ R√©cup√©ration du `fbp` g√©n√©r√© par le Pixel Facebook
        var fbp = null;
        if (window.fbq && typeof fbq.getState === "function") {
            fbp = fbq.getState().lastExternalId || null;
        }
  
        // ‚úÖ Stocker fbp et fbc si pr√©sents
        if (fbp) localStorage.setItem('fbp', fbp);
        if (fbc) localStorage.setItem('fbc', fbc);
    }
  
    getFacebookParams();
  </script>
  
  

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const urlParams = new URLSearchParams(window.location.search);
    const sessionId = urlParams.get("session_id");

    if (sessionId) {
      console.log("üì¶ Session ID d√©tect√© :", sessionId);

      fetch("/api/save-customer-id", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ sessionId }),
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          console.log("‚úÖ customerId enregistr√©");
        } else {
          console.warn("‚ö†Ô∏è save-customer-id a r√©pondu sans success :", data);
        }
      })
      .catch(err => console.error("‚ùå Erreur save-customer-id :", err));
    } else {
      console.warn("‚ö†Ô∏è Aucun session_id trouv√© dans l'URL");
    }
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const urlParams = new URLSearchParams(window.location.search);
    const sessionId = urlParams.get("session_id");

    if (sessionId) {
      console.log("üì¶ Session ID d√©tect√© :", sessionId);

      fetch("/api/save-customer-id", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ sessionId }),
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          console.log("‚úÖ customerId enregistr√©");
        } else {
          console.warn("‚ö†Ô∏è save-customer-id a r√©pondu sans success :", data);
        }
      })
      .catch(err => console.error("‚ùå Erreur save-customer-id :", err));
    } else {
      console.warn("‚ö†Ô∏è Aucun session_id trouv√© dans l'URL");
    }
  });
</script>

 
<noscript>
  <img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1139964937955152&ev=Purchase&noscript=1"/>
</noscript>


<script>
(function() {
  // Nombre al√©atoire / timestamp pour √©viter le cache
  const randomNumber = Date.now();

  // Si tu as un session_id Stripe dans l'URL : ?session_id=xxx
  const urlParams = new URLSearchParams(window.location.search);
  const transactionId = urlParams.get("session_id") || randomNumber;

  // Description de la transaction (lecture c√¥t√© TrafficJunky)
  const description = encodeURIComponent("MyAiCrush+Premium");

  // Cr√©ation du pixel TJ
  const img = document.createElement("img");
  img.id = "1000552661_cpa_testing";
  img.src = `https://ads.trafficjunky.net/ct?a=1000552661&member_id=1006784501&cb=${randomNumber}&cti=${transactionId}&ctv=40.00&ctd=${description}`;
  img.width = 1;
  img.height = 1;
  img.border = 0;
  img.style.display = "none";

  document.body.appendChild(img);
})();
</script>


<script>
  // G√©n√®re un num√©ro al√©atoire pour √©viter le cache
  const randomNumber = Date.now();

  // G√©n√®re un ID unique pour la transaction
  const transactionId = 'txn_' + Math.random().toString(36).substr(2, 9);

  // Description : tu peux modifier si tu veux d√©tailler le plan achet√©
  const transactionDescription = 'myaicrush_subscription';

  // Construction de l‚ÄôURL TrafficJunky
  const tjPixelUrl = `https://ads.trafficjunky.net/ct?a=1000552711&member_id=1007700561&cb=${randomNumber}&cti=${transactionId}&ctv=50.00&ctd=${transactionDescription}`;

  // Cr√©ation du pixel invisible
  const img = document.createElement('img');
  img.src = tjPixelUrl;
  img.width = 1;
  img.height = 1;
  img.style.display = 'none';

  // Ajout √† la page pour d√©clencher la conversion
  document.body.appendChild(img);
</script>



</body>
</html>
